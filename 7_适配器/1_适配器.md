- [MainActivity.java](#MainActivity.java)
- [InfoAdapter.java](#InfoAdapter.java)
- [Module.java](#Module.java)
- [activity_main.xml](#activity_main.xml)
- [list_item.xml](#list_item.xml)
- [strings.xml](#strings.xml)



## MainActivity.java

```java
package com.example.china;

import androidx.appcompat.app.AppCompatActivity;

import android.app.ActivityManager;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.Button;
import android.widget.ListView;
import android.widget.TextView;

import java.util.ArrayList;
import java.util.List;

public class MainActivity extends AppCompatActivity {

    // 定义控件
    private Button      btn;
    private ListView    lv;
    private TextView    tv_name;
    private TextView    tv_pid;
    private List<Module>  list;   // 里面存放了所有进程的PID 和 进程名
    private Module     module;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        init();

        btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                // 获取数据
                // 框架,  首先获取 活动服务
                ActivityManager manager =(ActivityManager) getSystemService(ACTIVITY_SERVICE);
                List<ActivityManager.RunningAppProcessInfo> infos =  manager.getRunningAppProcesses();

                // 将全局变量实例化
                list  =  new ArrayList<Module>();

                //获得进程 pid
                for(ActivityManager.RunningAppProcessInfo info : infos){
                    module =  new Module(info.pid, info.processName);  // 当前正在运行的进程pid 和名称
                    list.add(module); // 全部放入 容器内
 //                   tv_name.setText(module.getName());
//                    tv_pid.setText(module.getPid());

                }

                // 自定义适配器
                InfoAdapter adapter = new InfoAdapter(getApplicationContext(), list);

                // 绑定数据
                lv.setAdapter(adapter);
            }
        });

        // 给ListView 设置条目点击事件
        lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

            }
        });
    }

    private void init(){
        btn     =  findViewById(R.id.btn);
        lv      =  findViewById(R.id.lv);
    //    tv_name     =  findViewById(R.id.tv_name);
   //     tv_pid      =  findViewById(R.id.tv_pid);
    }

}
```





## 

## InfoAdapter.java

```java
package com.example.china;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;
import java.util.List;

// infoAdapter 就是 适配器类
// extends  继承
public class InfoAdapter extends BaseAdapter {
    private List<Module>    list;  // 容器
    private LayoutInflater  inflater;

     public InfoAdapter(){
         super();
     }

    public InfoAdapter(Context context, List<Module> list){
        super();
        this.list = list;
        inflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
         // 容器长度
        return  list == null ? 0: list.size();
    }

    @Override
    public Object getItem(int position) {
         // 获得某个下标的值
        return  list == null ? null: list.get(position);
    }

    @Override
    public long getItemId(int position) {
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
         if(convertView == null){
             // 加载布局
             convertView = inflater.inflate(R.layout.list_item,null);
         }
         ViewHolder holder =  ViewHolder.getViewHolder(convertView);

         //设置tv_pid 控件显示的文本
         holder.tv_pid.setText("[" + list.get(position).getPid() + "]");
         holder.tv_name.setText(list.get(position).getName());

        return convertView;
    }

    // 自定义的适配器
    static final  class ViewHolder{
        public TextView tv_pid;
        public TextView tv_name;


        public ViewHolder(View convertView){
            tv_pid = convertView.findViewById(R.id.tv_pid);
            tv_name =  convertView.findViewById(R.id.tv_name);
        }

        public static ViewHolder getViewHolder(View convertView){
            ViewHolder holder = (ViewHolder) convertView.getTag(); // convertView.getTag() 保存了返程信息
            if(holder == null){
                holder = new ViewHolder(convertView);
                convertView.setTag(holder);
            }
            return null;
        }
    }
}

```





## Module.java

```java
package com.example.china;

public class Module {

    // 定义成员变量
    private  int      pid;
    private  String   name;

    // 构造方法
    public Module(){
        super();
    }

    public Module(int pid, String name){
        super();
        this.name = name;
        this.pid  = pid;
    }


    public int getPid() {
        return pid;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setPid(int pid) {
        this.pid = pid;
    }
}

```



## activity_main.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity"
    android:background="#FFFFe1"
    android:orientation="vertical">

<!-- android:textAllCaps="false" 关闭自动将字母进行大写的设置   -->
    <Button
        android:id="@+id/btn"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/getProgremName"
        android:textAllCaps="false"
    />

<!--  android:divider="#b6ac00"   分界线颜色 , 必须设置分界线宽度,才会显示出来  -->
<!--  android:dividerHeight="3dp"   分界线宽度-->
    <ListView
        android:id="@+id/lv"
        android:divider="#b6ac00"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:dividerHeight="3dp"
        />
</LinearLayout>
```





## list_item.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:orientation="horizontal"
    android:layout_height="match_parent">

    <TextView
        android:gravity="center"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:id="@+id/tv_pid"
        android:text="@string/str_pid"
        android:textColor="#e20000"
        android:textSize="19sp"
        />

    <TextView
        android:gravity="center"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:id="@+id/tv_name"
        android:text="@string/str_name"
        android:textColor="#e20000"
        android:textSize="19sp"
        />
</LinearLayout>
```





## strings.xml

```xml
<resources>
    <string name="app_name">China</string>

    <string name="getProgremName">获取当前正在运行的进程</string>
    <string name="str_pid">显示进程 pid</string>
    <string name="str_name">显示进程名</string>
</resources>
```



